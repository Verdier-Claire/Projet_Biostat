---
title: "Biostat_projet"
author: "Claire et Lucie"
date: "01/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```

Le Danemark est un pays scandinave. Pour ce pays, nous allons étudier les différentes causes de mortalités en fonction de l'âge des individus, de la période où elles sont mortes.


# Explications du jeu de données 
```{r}
mort <- read.csv("mortDK.csv", header = TRUE, sep = ";")
mort <- mort %>% rename("taux.deces" = rt, 
                        "Infections" = r1,
                        "Cancer"= r2,
                        "Tumeurs.Bénignes" = r3, 
                        "Endocrine" = r4, 
                        "Maladies.Sang" = r5, 
                        "Systeme.Nerveux" = r6, 
                        "Cerebrovasculaire" = r7, 
                        "Cardiaque" = r8, 
                        "Maladies.Respiratoires" = r9, 
                        "Maladies.Foie" = r10, 
                        "Maladies.Digestives" = r11, 
                        "Maladie.Génito_urinaire" = r12, 
                        "Non.Definis" = r13, 
                        "Mort.Naturelle" = r14, 
                        "Mort.Violente" = r15) %>%
          select(-ï..)
mort$sex <- mort$sex %>% factor( labels = c("H", "F"))
mort$periode <- mort$periode %>% factor( labels =c("43-47", "48-52",
                                                   "53-57", "58-62",
                                                   "63-67", "68-72",
                                                   "73-77", "78-82",
                                                   "83-87", "88-92"))
mort$age <- mort$age %>% factor()
```

Le jeux de données est composé de 1820 observations et 21 variables. Ces 
variables sont l'âge, le sexe, la période, le nombre de décès, le taux de décès 
et 15 variables sur l'identification du décès. Lorsque qu'on parle 
d'identification du décès, on parle si la personne est morte d'un cancer, 
d'une mort naturelle, par exemple.  

La variable *taux.deces* est calculée d'après la formule suivante : 
$$\mbox{taux.deces}=\frac{1000\times \mbox{nb.deces}}{PA}$$  
Les 15 variables d'identification du décès sont calculés de la même manière.


```{r}
summary(mort)
```

\textcolor{green}{TODO : description du data avec stat descriptives ?}

```{r}
head(mort)
```

Entre les années 1943 et 1948, 224 654 nourissons étaient de sexe masculins. 12 072 d'entre eux sont morts. Ce qui représente environ 53 individus issus de cette catégorie sur 1000 sont morts sur cette période.  \textcolor{green}{TODO plus détailler une autre ligne}


## Modèle a choisir, lequel on fait (beaucoup de variables, avec pleins de catégories)
### Modalité de référence
```{r}
# contrasts(mort$age)
contrasts((mort$periode))
contrasts(mort$sex)
```

La modalité de référence est l'âge zéro. La modalité de référence pour la
période temporelle est entre 1943 et 1947. Enfin la modalité de référence au 
niveau sexe est l'homme.  \textcolor{green}{TODO changer la modalité de ref de 
l'âge}

\textcolor{green}{TODO choisir un modèle}
```{r}
# glm(nb.deces ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Infections ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Cancer ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Tumeurs.Bénignes ~ periode * sex * age,  offset = log(PA), data = mort)
endocrine <- glm(Endocrine ~ periode + sex + age,  offset = log(PA), 
                 data = mort)
# glm(Maladies.Sang ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Cerebrovasculaire ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Cardiaque ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Maladies.Respiratoires ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Maladies.Foie ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Maladies.Digestives ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Maladie.Génito_urinaire ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Non.Definis ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Mort.Naturelle ~ periode * sex * age,  offset = log(PA), data = mort)
# glm(Mort.Violente ~ periode * sex * age,  offset = log(PA), data = mort)

```

