---
title: "Biostat_projet"
author: "Claire et Lucie"
date: "01/12/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```

Le Danemark est un pays scandinave. Pour ce pays, nous allons étudier les différentes causes de mortalités en fonction de l'âge des individus, de la période où elles sont mortes.


# Explications du jeu de données 
```{r}
mort <- read.csv("mortDK.csv", header = TRUE, sep = ";")
mort <- mort %>% rename("taux.deces" = rt, 
                        "Infections" = r1,
                        "Cancer"= r2,
                        "Tumeurs.Bénignes" = r3, 
                        "Endocrine" = r4, 
                        "Maladies.Sang" = r5, 
                        "Systeme.Nerveux" = r6, 
                        "Cerebrovasculaire" = r7, 
                        "Cardiaque" = r8, 
                        "Maladies.Respiratoires" = r9, 
                        "Maladies.Foie" = r10, 
                        "Maladies.Digestives" = r11, 
                        "Maladie.Génito_urinaire" = r12, 
                        "Non.Definis" = r13, 
                        "Mort.Naturelle" = r14, 
                        "Mort.Violente" = r15)
mort <- mort %>% select(-X)
mort$sex <- mort$sex %>% factor( labels = c("H", "F"))
mort$periode <- mort$periode %>% factor( labels =c("43-47", "48-52",
                                                   "53-57", "58-62",
                                                   "63-67", "68-72",
                                                   "73-77", "78-82",
                                                   "83-87", "88-92"))


summary(mort)
head(mort)
```

Le jeux de données est composé de 1820 observations et 21 variables. Ces variables sont l'âge, le sexe, la période, le nombre de décès, le taux de décès et 15 variables sur l'identification du décès. Lorsque qu'on parle d'identification du décès, on parle si la personne est morte d'un cancer, d'une mort naturelle, par exemple.  

La variable *taux.deces* est calculée d'après la formule suivante : 
$$\mbox{taux.deces}=\frac{1000\times \mbox{nb.deces}}{PA}$$  
Les 15 variables d'identification du décès sont calculés de la même manière.  

Entre les années 1943 et 1948, 224 654 nourissons étaient de sexe masculin. 12 072 d'entre eux sont morts. Ce qui représente environ 53 individus issus de cette catégorie sur 1000 sont morts sur cette période. 

Au vu de notre jeu de données, il semble évident que nous allons réaliser une enquète de cohorte. En effet, la principale caractéristique d'une enquète de cohorte est qu'elle permet de suivre les individus dans le temps sur une période donnée.

De plus, nous savons que les résultats d'une enquète de cohorte peuvent être représentés sous 2 deux formes différentes. Ici, nous avons le cas où pour chaque combinaison de modalité des covariables, nous avons le nombre de décès observés pendant la période de suivie $[t_1,t_2]$ ainsi que le nombre de personnes-années correspondant. Nous avons un tableau de morbidité. 

Un individu pourra donc, au cours du suivi, contribuer aux personnes-années de différentes strates, si l'une au moins de ses covariables évolue au cours du temps.

Notre objectif est donc de déterminer si les covariables *âge, sexe* et *période* ont un effets sur les différentes causes de mortalité. Nous utiliserons des modèle de Poisson. 

Au vu de notre grand nombre d'observations, on décide de se restraindre à la tranche des 18-25ans.
```{r}
mort <- mort %>% filter((age >=18) & (age <=25))
mort$age <- mort$age %>% factor()
contrasts(mort$age)
```


## Modèle a choisir, lequel on fait (beaucoup de variables, avec pleins de catégories)

## Etude du nombre de décès chez les danois de 18-25ans.
```{r}
ggplot(mort)+
  geom_point(aes(x=age, y=nb.deces, color=sex))+
  ggtitle("Nombre de décès chez les danois de 18-25ans")
```
Sur le graphique on constate que les jeunes danois sont plus touchés par la mort que les jeunes danoises.
Regardons maintenant en fonction de la période :

```{r}
ggplot(mort)+
  geom_point(aes(x=age, y=nb.deces, color=periode))+
  ggtitle("Nombre de décès chez les danois de 18-25ans")
```

```{r}
mdoel_nb_deces<-glm(nb.deces ~ periode * sex * age,  offset = log(PA), family = "poisson", data = mort)
summary(mdoel_nb_deces)
```
Parmis la sous-strates 43-47, on fait la comparaison entre 2 sous strates :

  • la sous-strate "18 ans et sexe=H" : le rapport $\frac{nb.decss}{pa}$ est $e^{-6.3}$
  
  • la sous-strate "18 ans et sexe=F" : le rapport $\frac{nb.decss}{pa}$ est $e^{-6.3}$x$e^{-0.35}$
  
Si on compare les deux dernieres sous-strates, le rapport d'incidence moyenne sexe feminin et sexe masculin, à âge fixé de 18 ans vaut $e{-0.35}=0.70$


## Etude du nombre de décès par maladie de foie chez les danois de 18-25ans.

```{r}
ggplot(mort)+
  geom_point(aes(x=age, y=Maladies.Foie, color=sex))+
  ggtitle("Nombre de décès par maladies de foie chez les danois de 18-25ans")
```
On remarque que ce sont les danoises plus touchées par les maladies de foie.
Regardons maintenant en focntion de la période :

```{r}
ggplot(mort)+
  geom_point(aes(x=age, y=Maladies.Foie, color=periode))+
  ggtitle("Nombre de décès chez les danois de 18-25ans")
```
De nouveau, on remarque que plus l'époque est lointaine, plus le nombre de décès à cause de problème liés au foie est élevé quel que soit l'âge des jeunes.

Essayons donc maintenant d'expliquer le pourcentage de décès du aux maladies du foies en fonction de la période, du sexe et de l'âge des individus :
```{r}
model_maladie.foie<-glm(Maladies.Foie ~ periode * sex * age,  offset = log(PA),  data = mort)
summary(model_maladie.foie)
```
Parmis la sous-strates 43-47, on fait la comparaison entre 2 sous strates :

  • la sous-strate "18 ans et sexe=H" : le rapport $\frac{Maladies.Foie}{pa}$ est $e^{-12}$
  
  • la sous-strate "18 ans et sexe=F" : le rapport $\frac{Maladies.Foie}{pa}$ est $e^{-12}$x$e^{0.02}$
  
Si on compare les deux dernieres sous-strates, le rapport d'incidence moyenne sexe feminin et sexe masculin, à âge fixé de 18 ans vaut $e{0.02}= 1.02$

```{r}
model_mort.viol<-glm(Mort.Violente ~ periode * sex * age,  offset = log(PA), data = mort)
summary(model_mort.viol)
```

